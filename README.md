# MediaHunter

MediaHunter — консольное C++-приложение для анализа мультимедийных файлов на наличие вредоносного кода и скрытых угроз. Проект предназначен для проверки изображений, аудио, видео и документов на наличие опасных или скрытых компонентов. MediaHunter позволяет выполнять различные виды анализа, включая сигнатурное сканирование на основе правил YARA, извлечение и проверку метаданных через ExifTool, анализ стеганографии, проверку корректности расширений файлов и общий комплексный анализ всего содержимого.

# Основные модули
Сигнатурный анализ (YARA): поиск известных вредоносных шаблонов в файлах с помощью правил YARA.
Анализ метаданных (ExifTool): извлечение и проверка метаданных (EXIF и других) файлов с целью обнаружения скрытой информации или некорректных значений.
Анализ стеганографии: проверка файлов (в основном изображений) на наличие скрытых встраиваний через LSB-анализ и другие эвристики.
Проверка расширений файлов: определение реального формата файла по сигнатуре и сравнение его с расширением; обнаружение попыток маскировки расширений.
Общий анализ: последовательное выполнение всех перечисленных проверок (сигнатурный анализ, метаданные, стеганография, расширения) для максимальной глубины сканирования.

# Поддерживаемые форматы файлов
Изображения: JPEG, PNG, BMP, GIF, TIFF, PSD, WEBP, EMF, WMF и другие популярные графические форматы.
Аудио: MP3, а также другие аудиоформаты при расширении функциональности проекта.
Видео: MP4, WebM, MKV, AV1, HEVC и прочие форматы видеофайлов.

# Установка зависимостей
Перед сборкой убедитесь, что все внешние зависимости установлены и доступны:
ExifTool: загрузите Windows-версию ExifTool с официального сайта. Полученный исполняемый файл (exiftool(-k).exe) поместите в любую папку, а затем добавьте путь к ней в системную переменную PATH. Для удобства можно переименовать exiftool(-k).exe в exiftool.exe. Это позволит запускать команду exiftool из любого места.
YARA: скачайте готовые сборки для Windows (DLL, LIB и заголовочный файл yara.h) из репозитория YARA на GitHub или с официального сайта. Выберите сборку, соответствующую вашей архитектуре (x64 или x86). Поместите файлы библиотеки (например, yara.lib) и заголовочный файл в известное место. При настройке проекта добавьте путь к заголовкам YARA и укажите в линковщике yara.lib (либо путь к yara-64.dll, если используете динамическую библиотеку).
FFmpeg (опционально): если планируется анализ видео/аудио, скачайте сборку FFmpeg для Windows с официального сайта. Добавьте папку с ffmpeg.exe в PATH системы или укажите путь явно. (На данный момент FFmpeg в коде не используется напрямую, но может пригодиться для будущих расширений функционала.)
OpenCV (опционально): для дополнительных возможностей обработки изображений можно установить OpenCV. Скачайте Windows SDK OpenCV с официального сайта, установите его и укажите пути к библиотекам и заголовочным файлам в проекте (если понадобятся).

# Сборка в Visual Studio
Создайте проект: Запустите Visual Studio и создайте новый проект типа Win32 Console Application или просто Console App. Укажите имя (например, MediaHunter) и выберите C++ в качестве языка.
Добавьте файлы: Перетащите все перечисленные исходные файлы (.cpp) и заголовки (.h, а также stb_image.h и rules.yar) в проект, либо добавьте их через пункт меню Add > Existing Item.
Настройте стандарты: В свойствах проекта (Project > Properties) включите стандарт C++17 (или более новый). Убедитесь, что настроена поддержка std::filesystem (обычно это автоматично при использовании /std:c++17).
Укажите пути к заголовкам и библиотекам:
1) Во вкладке C/C++ → General → Additional Include Directories добавьте путь к папке с заголовочным файлом YARA (там, где лежит yara.h).
2) Во вкладке Linker → General → Additional Library Directories укажите путь к папке с библиотеками YARA (yara.lib).
3) В Linker → Input → Additional Dependencies добавьте yara.lib (и другие библиотеки, если понадобятся).
4) Если используете FFmpeg или OpenCV, укажите аналогично их директории и библиотеки.
Платформенная настройка: Убедитесь, что конфигурация проекта соответствует архитектуре скачанной YARA (x64 или Win32). Выберите подходящую платформу.
Компиляция: Соберите проект (Build). Если всё настроено верно, вы получите исполняемый файл MediaHunter.exe в папке Debug или Release выбранной конфигурации.

# Сборка из командной строки (опционально)
Если вы предпочитаете собирать проект без IDE, можно использовать компилятор Microsoft Visual C++ из командной строки (Developer Command Prompt) или GCC/MinGW:
Visual C++ (cl.exe): Откройте командную строку разработчика и выполните команду, учитывая пути к заголовкам и библиотекам YARA. Пример:
cl /EHsc /std:c++17 main.cpp file_reader.cpp report_generator.cpp signature_scanner.cpp metadata_checker.cpp steganography_checker.cpp extension_checker.cpp full_analyzer.cpp /I"C:\path\to\yara\include" "C:\path\to\yara\lib\yara.lib"
Замените пути на актуальные. Параметр /EHsc включает обработку исключений.
MinGW (g++): Если у вас установлен MinGW, можно использовать такую команду:
g++ -std=c++17 main.cpp file_reader.cpp report_generator.cpp signature_scanner.cpp metadata_checker.cpp steganography_checker.cpp extension_checker.cpp full_analyzer.cpp -I"path/to/yara/include" -L"path/to/yara/lib" -lyara -o MediaHunter.exe
Укажите пути и имя библиотеки (-lyara) в соответствии с вашей системой.
Убедитесь, что stb_image.h и другие заголовки доступны через -I или находятся в той же директории.
После сборки убедитесь, что в каталоге с MediaHunter.exe лежит rules.yar (файл правил YARA), а также что ExifTool доступен из PATH.
